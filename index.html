<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Putt Till You DIE</title><style> * {margin: 0;padding: 0;outline: 0;user-select: none;color: #eee;text-shadow: 2px 2px 1px #000;text-align: center;font-weight: 900;}html {font-family: "Bradley Hand ITC", "Bradley Hand Bold";line-height: 2.0em;background-color: #7bb87b;overflow: hidden;}#fg, #hud {left: 0;top: 0;}#ok {margin-top: 1em;display: inline-block;width: 2em;height: 1em;border-radius: 2em;line-height: 1em;border: 4px solid #232;background-color: #595;font-size: 5em;}#ok:active {transform: scale(.9);}.i {display: none;}#ss {border-top: 4px solid #9b9;background-color: #595;border-bottom: 4px solid #373;}#ts, #is, #ss {width: 100%;z-index: 1000;top: 50%;left: 50%;-webkit-transform: translate(-50%, -50%);transform: translate(-50%, -50%);}h3 {font-size: 5em;line-height: 1.5em;}h4 {font-size: 25em;line-height: .6em;}h5 {font-size: 1.7em;line-height: .7em;}.h {width: 210px;height: 80px;}h1 {font-size: 2em;}h2 {font-size: 3em;}h6 {font-size: 2.5em;line-height: 1.10em;}#bg, #fg, #hud, #ts, #is, #ss, .h {position: absolute;}</style></head><body oncontextmenu="return!1"><img id="i" class="i" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAAAiCAMAAADs8u6hAAABgFBMVEUAAACTyf6Tyf6Tyf7n3c7T2Nvn3c7n3c7n3c7n3c7M19+Tyf7n3c7n3c7n3c6Tyf6Tyf6Tyf6Tyf7n3c7n3c7n3c6Tyf7n3c7n3c7n3c7n3c6Tyf6Tyf6Tyf7n3c6Tyf6Tyf6Tyf6Tyf6Tyf6Tyf7n3c7n3c7n3c7n3c4AAADn3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c6Tyf7n3c6Tyf4AAADn3c7n3c7n3c4AAADn3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c6Tyf6Tyf4AAACTyf6Tyf7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c7n3c4AAADn3c7n3c7n3c4AAAAAAAAAAAAAAAAAAACTyf4AAACTyf4AAADn3c4AAAAAAADn3c4AAAAAAAAAAAAAAAAAAAD///8AAADk5OQPDw+hoaF1dXXT09PIyMiRkZFYWFgVFRX6+vqlpaX19fXZ2dmEhIRgYGAjIyPx8fHw8PBra2v3Pv23AAAAa3RSTlMAVVMkFgQRHRQOAjsZCgcfLUgnPCMuWSd4ZypbT0pHRjg3MBoUSzMxDPlRIWNdQH1WQz85CPODcCiuiodON6COc2xbq5JgSzUtHQu1sJ2UVCUfuoBu1qijl4dJPaRWIiIP3poRxr18YyCZGvSR798AAATTSURBVEjHzZYHb9pQFIW9MCZmmI1DGGHGbELYI8zshKTZbdK9eSGj6V5/vfdBWYkEVYfUI2Qhy/p8fN9dxD/VlEytVs0pWJbjuJ8XxZxKrZZNjTy14FmldTp61bMA92/pwf7+g1tcmVqlUihYjmEYrnNhFQqVSi0bIk+tuQVeO0NRM1pecK/dRmcRyt7ggmHsl1Eq5T+lVDLYM1juAWQewUGZyI5MlEPwyG5wVxBo5ZZfjJUbtjPTHWXMBjlGDzwvuJ2UldTyLkFw8VrSSjndCzcMt6+u2iOWO1wOsGajr5jQgxJFnzEDaK5D7jzj5k1Wm4vWQIzh4rJZTbxbNmr4otW6GLGsxn6BO+1PROJ2L8huj+h9RnOwQ1bjj/I4TaZ5WqODIEOIdRp63mRyeobjfNL+2Gp9bJ8Mg1VzLANcn97ubcaq4XC4GgvYIwl/Jqhk51QYvCZQ1vn7mtklqqOlWc39eSslrPUZL0/R5xboMzp92b+pwoEIYm6g2hAr6fReRWzECna93yxnIDfAsNthtdEaniQdy4Kw7CBJXkPbrA43WH7y4ji7LyH09isGf3uLkLSfPX7xBMAKBTZsBG5Y3LNEd1O7UcueWA3YE0aDEnIDTk6gSJdmlqRmIb7wm6XIWY2LpAQ4v6fAvDi//PCu1dG7D5fnF0B/isEsp9wx+yKFqpi2pHKL9cVcPloWq4WILwOWFQTh4U1aWrcENJq32Xga3rGko7Um3kMQjxA6a93QGUKPAMyyDESiaI+FKpbU4tZmafOonoumQzGwDFFmCWJVC9/OUw6anidB8zTtoOAGqV0liLsSenMT/AZJdwHMcfjoEt6qWI7mtkoHtYPDza18tBIuRPzbSg7A9AzporXUMrAop5OCtyxTWtpFztAEkJPS+Sj3vQRcEMMocYgLYWz48cHG+kbt8PFiqhwKxH1wfBxB6ChS0M1QAm0jnQ8fOkkbLVAzOoGkdAToXhK9H+GiJHCHwI29aL6+WVu/s75xUNrKW8Tmr4Ex+dOA+wkl7xHD4EAoDeDSxp1nd9ZrpaOcRYx1wRNCgcnSlwH4iwTcceC+4/GHhzUlXQ/A11KvILl+KCDGP0OxWc9bQoGIH4PHpxvWynBivOn3CxayIghZERbLu7mjw9pGDbIit1sO4awA8PgCwTpFV530PcNVcoVOe2AWKjqD8xhbPiodlh7XcylLJezV+w0AHl/SWMcIgJcXEvp+CX/QMQHqlbTZF4eKTuMK2aov5nct3QIxKAE8sQll0fnZdRslk6h9fXbenyMwPDgcZG+sIZYtqXwun4pa0mIY0ng6CAUyuW0+QiDp1esnxxIC7ffAeHzsZIpxIIPnKPSgckUMN+16I5wdy05u9EmgnTzoDNQT+JscavSc0mBMxAuxsFgpl9MVMRRueiNdw4rJo+l5MrvSnyTZ5PPeaMJkiLI/Efc2q41QKNSATu+NF42QEzCtxwzT8ZLB0JtjlTsZYxFmSCHQDAS89ri+iCcIB41+zPgfr6mpLlm+Pe0v6vURUG+cMng0jVlYJqlLhjIxTxuNfizjdGY7KGe6w3SCJpNhBQgaDGasbUMQFove+P8DDZYWuXwHJMfYwcLy52QWWh0WYHsr1t9aODkGBFiw+5t+x2+ckL/dNfb/0w83dylbb8aVTwAAAABJRU5ErkJggg=="><div id="hud" class="i"><div id="hd" class="h"><h1>HOLE</h1><h2 id="ht">1</h2></div><div id="pd" class="h"><h1>PUTTS</h1><h2 id="pt">0</h2></div><div id="td" class="h"><h1>TOTAL</h1><h2 id="tt">0</h2></div><div id="ad" class="h"><h1>AVERAGE</h1><h2 id="at">0</h2></div></div><div id="ts" class="i"><h3>PUTT TILL YOU</h3><h4>DIE</h4><h5>An Antix Development production for js13k 2022</h5><a id="ok" onclick="jf()">OK</a></div><div id="is" class="i"><h3>INSTRUCTIONS</h3><br><h6>HOLD AND MOVE THE LEFT MOUSE BUTTON TO AIM,<br>A LONGER LINE MEANS MORE PUTT POWER.<br><br>RELEASE LEFT MOUSE BUTTON TO PUTT.<br><br>PRESS SPACE KEY TO CANCEL AIMING,<br>OR RELEASE LEFT MOUSE BUTTON WHILE PUTTER IS RED.<br><br>AVOID SAND AND WATER TRAPS.<br><br>HOLD THE SHIFT KEY TO SHOW YOUR STATISTICS.</h6><a id="ok" onclick="jg()">OK</a></div><div id="ss" class="i"><h3>STATISTICS</h3><h6 id="s0"></h6><br><h6 id="s1"></h6><h6 id="s2"></h6><h6 id="s3"></h6><br><h6 id="s4"></h6><br><h6 id="s5"></h6><h6 id="s6"></h6><h6 id="s7"></h6><br><h6 id="s8"></h6><h6 id="s9"></h6><br><br></div></body><script>const e=Date.now(),t=document,l=window,a=l.localStorage,o=Math,s=o.PI,r=2*o.PI,n=o.sin,c=o.cos,f=o.imul,d=o.atan2,h=o.ceil,x=o.floor,_=o.hypot,b=o.min,u=o.abs;SOUND_WATER=0,SOUND_SAND=1,SOUND_PUTT=2,SOUND_WALL=3,SOUND_GOAL=4,SOUND_HOLEINONE=5,SOUND_SOCLOSE=6,SOUND_BUTTON=7,SOUND_BLOCKER=8,SOUND_WINDMILL=9,SOUND_BALLFIXED=10,MODE_NONE=0,MODE_INSTRUCTIONS=1,MODE_PLAY=2,MODE_FADE_OUT=3,MODE_FADE_IN=4,oneCell=160,halfCell=80,canvasWidth=804,canvasHeight=804;let g,O,p,E,D,N,$,S,m,k,v,y,T,A,w,C,M,U,L,I,R,F,G,B,W,H,P,X,Y,J,V,q,K=[],j=0,z=null,Q={t:null,l:12},Z=[],ee=!1,te={width:0,height:0,o:0,i:!0,h:1,_:0,u:.35,g:.35},le=e=>document.getElementById(e),ae=e=>t.body.style.opacity=`${e}`,oe=e=>le(e).classList.add("i"),se=e=>le(e).classList.remove("i"),re=(e,t)=>le(e).innerHTML=t,ne=(e,t,l)=>e<t?t:e>l?l:e,ie=e=>{j=e,console.log(`gameMode changed to ${["MODE_NONE","MODE_INSTRUCTIONS","MODE_PLAY","MODE_FADE_OUT","MODE_FADE_IN"][e]}`)},ce=(e,l,a)=>{let o=t.createElement("canvas"),s=o.getContext("2d");var r;return o.O=s,o.width=e,o.height=l,o.id=a,r=o,t.body.appendChild(r),o},fe={p:e=>{fe.seed=e},D:()=>fe.seed,random:()=>{fe.seed+=1831565813;let e=fe.seed;return e=f(e^e>>>15,1|e),e^=e+f(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}},de=()=>fe.random(),he=(e,t)=>(e=h(e),x(de()*(x(t)-e+1)+e));gV=.5,sR=44100,aC=null,fx=[],fx_add=e=>fx.push(fx_bS(...e)),fx_play=e=>fx_pS(fx[e]),fx_pS=e=>{aC||(aC=new(l.AudioContext||l.webkitAudioContext));const t=aC.createBuffer(1,e.length,44100),a=aC.createBufferSource();return t.getChannelData(0).set(e),a.buffer=t,a.connect(aC.destination),a.start(0),a},fx_bS=(e,t,l,a,s,i,f,d,h,x,_,g,O,p,E,D,N,$,S)=>{let m,k,v=44100,y=d*=500*r/v/v,T=t*=r/v,A=[],w=0,C=0,M=0,U=1,L=0,I=0,R=0;for(h*=500*r/v**3,p*=r/v,x*=r/v,_*=v,g=g*v|0,k=(l=l*v+9)+($*=v)+(a*=v)+(s*=v)+(D*=v)|0;M<k;A[M++]=R)++I%(100*E|0)||(R=i?i>1?i>2?i>3?n((w%r)**3):o.max(b(o.tan(w),1),-1):1-(2*w/r%2+2)%2:1-4*u(o.round(w/r)-w/r):n(w),R=(g?1-S+S*n(r*M/g):1)*(R>0?1:-1)*u(R)**f*e*.5*(M<l?M/l:M<l+$?1-(M-l)/$*(1-N):M<l+$+a?N:M<k-D?(k-M-D)/s*N:0),R=D?R/2+(D>M?0:(M<k-D?1:(k-M)/D)*A[M-D|0]/2):R),m=(t+=d+=h)*c(p*C++),w+=m-m*O*(1-1e9*(n(M)+1)%2),U&&++U>_&&(t+=x,T+=x,U=0),!g||++L%g||(t=T,d=y,U=U||1);return A};let xe=(e,t)=>({x:e,y:t}),_e=e=>Oe(e,e)**.5,be=(e,t)=>xe(e.x+t.x,e.y+t.y),ue=(e,t)=>be(e,ge(t,-1)),ge=(e,t)=>xe(e.x*t,e.y*t),Oe=(e,t)=>e.x*t.x+e.y*t.y,pe=(e,t)=>e.x*t.y-e.y*t.x,Ee=(e,t,l,a=e.x-t.x,o=e.y-t.y)=>xe(a*c(l)-o*n(l)+t.x,a*n(l)+o*c(l)+t.y),De=e=>ge(e,1/(_e(e)||1)),Ne=(e,t)=>_e(ue(e,t)),$e=[],Se={},me=(e,t,l,a)=>{e.N=t,e.$=l,e.S=a,e.E=be(a,ge(l,t))},ke=(e,t,l,a,o,s,r,n,i)=>(i={m:o,t:e,k:l,v:a,T:t?1/t:0,A:xe(0,0),C:xe(0,0),M:0,U:0,a:0,l:s,L:r,I:n,R:o?(_(r,n),t>0?1/(t*(r**2+n**2)/12):0):t>0?t*s**2/12:0,$:[],F:[xe(e.x-r/2,e.y-n/2),xe(e.x+r/2,e.y-n/2),xe(e.x+r/2,e.y+n/2),xe(e.x-r/2,e.y+n/2)]},o&&Te(i),$e.push(i),i),ve=(e,t,l)=>{e.t=be(e.t,t)},ye=(e,t,l)=>{if(e.M+=t,e.m){for(l=4;l--;)e.F[l]=Ee(e.F[l],e.t,t);Te(e)}},Te=(e,t)=>{for(t=4;t--;)e.$[t]=De(ue(e.F[(t+1)%4],e.F[(t+2)%4]))},Ae=(e,t,l)=>{if(!e.m&&t.m&&([e,t]=[t,e]),e.m&&!t.m){var a,o,s,r,n,i,c=1,f=-1e9,d=0;for(a=4;a--;){if(s=t.t,o=ue(s,e.F[a]),(r=Oe(o,e.$[a]))>0){f=r,d=a,c=0;break}r>f&&(f=r,d=a)}if(c)me(Se,t.l-f,e.$[d],ue(s,ge(e.$[d],t.l)));else{var h=ue(s,e.F[d]),x=ue(e.F[(d+1)%4],e.F[d]),_=Oe(h,x);if(_<0){if((n=_e(h))>t.l)return;i=De(h),me(Se,t.l-n,i,be(s,ge(i,-t.l)))}else if(h=ue(s,e.F[(d+1)%4]),x=ge(x,-1),(_=Oe(h,x))<0){if((n=_e(h))>t.l)return;i=De(h),me(Se,t.l-n,i,be(s,ge(i,-t.l)))}else{if(!(f<t.l))return;me(Se,t.l-f,e.$[d],ue(s,ge(e.$[d],t.l)))}}return 1}},we=(e,t,l)=>{if(e.T||t.T){var a=l.N/(e.T+t.T)*.8,o=ge(l.$,a),s=l.$;ve(e,ge(o,-e.T)),ve(t,ge(o,t.T));var r=ge(l.S,t.T/(e.T+t.T)),n=ge(l.E,e.T/(e.T+t.T)),i=be(r,n),c=ue(i,e.t),f=ue(i,t.t),d=be(e.A,xe(-1*e.U*c.y,e.U*c.x)),h=be(t.A,xe(-1*t.U*f.y,t.U*f.x)),x=ue(h,d),_=Oe(x,s);if(!(_>0)){var u=b(e.v,t.v),g=b(e.k,t.k),O=pe(c,s),p=pe(f,s),E=-(1+u)*_/(e.T+t.T+O*O*e.R+p*p*t.R),D=ge(s,E);e.A=ue(e.A,ge(D,e.T)),t.A=be(t.A,ge(D,t.T)),e.U-=O*E*e.R,t.U+=p*E*t.R;var N=ge(De(ue(x,ge(s,Oe(x,s)))),-1),$=pe(c,N),S=pe(f,N),m=-(1+u)*Oe(x,N)*g/(e.T+t.T+$*$*e.R+S*S*t.R);m>E&&(m=E),D=ge(N,m),e.A=ue(e.A,ge(D,e.T)),t.A=be(t.A,ge(D,t.T)),e.U-=$*m*e.R,t.U+=S*m*t.R}}},Ce=(e,t,l,a,o,s=0)=>ke(e,l,a,o,0,t,s),Me=(e,t,l,a,o,s)=>ke(e,a,o,s,1,_(t,l)/2,t,l),Ue=()=>{console.log("advancing to next hole"),v.G++,v.B=0,Le(),Ve(),y=0,ie(4)},Le=()=>{console.log("RANDOMSEED:"),console.log(fe.D()),v.seed=fe.D();let e=3;te.o=4,te.h=.3,te.u=.3,te.g=.25,v.G<4&&(te.u=0),v.G>5&&(e++,te.o=6,te.h=.45,te.u=.4,te.g=.3),v.G>10&&(te.o=8,te.h=.6,te.u=.5,te.g=.35),v.G>15&&(e++,te.o=10,te.h=.75,te.u=.6,te.g=.4),te.width=he(3,e),te.height=he(3,e),console.log("GENERATOR PARAMS:"),console.log(te),Z=[],$e=[],Fe(te),We(te),Ge(),Be(),He(),console.log("hole generated")},Ie=(e,t)=>e.W|=t,Re=e=>e.H=!0,Fe=e=>{const t=e.o-1,l=e.width-1,a=e.height-1;let o=()=>{c<a?(Re(X),Ie(X,4),c++,n(),Ie(X,1),W++,r()):s()},s=()=>{Re(X),de()<.5?(Y=H.P,Y.X=!1,Y.Y=!0,H.J=Y,H.P=X,X.X=!0,console.log("hole direction reversed")):(X.Y=!0,H.J=X),f=!0},r=()=>{movingEast=i!==l&&(0===i||de()<.5)},n=()=>{X=P[c][i]},i=he(0,l),c=0,f=!1;for(H=(e=>{P=[];for(let t=0;t<e.height;t++){let l=[];for(let a=0;a<e.width;a++)l.push({W:0,V:t,q:a});P.push(l)}return{width:e.width,height:e.height,K:0,j:0,Z:0,ee:0,te:P}})(te),W=0,P=H.te,n(),X.X=!0,H.P=X,Re(X),r();!f;)movingEast?de()<.7&&i<l&&i<l?(Re(X),Ie(X,2),i++,n(),Ie(X,8),W++):o():de()<.7&&i>0&&i>0?(Re(X),Ie(X,8),i--,n(),Ie(X,2),W++):o(),-1!=t&&W>=t&&s()},Ge=()=>{const e=H.te;(()=>{for(let t=0;t<H.width;t++)for(let l=0;l<H.height;l++)if(e[l][t].H)return void(H.K=t);H.K=0})(),(()=>{for(let t=H.width-1;t>0;t--)for(let l=0;l<H.height;l++)if(e[l][t].H)return void(H.j=t);H.j=H.width-1})();for(let t=H.height-1;t>0;t--)for(let l=0;l<H.width;l++)if(e[t][l].H)return void(H.ee=t);H.ee=H.height-1},Be=()=>{let e=[];for(let t=0;t<=H.ee;t++){let l=[];for(let e=H.K;e<=H.j;e++)l.push(H.te[t][e]);e.push(l)}H.width=H.j-H.K+1,H.height=H.ee+1,H.te=e},We=e=>{if(e.i){let t=[],l=[],a=(e,t)=>{e.le||e.H||(e.le=!0,e.ae=t,l.push(e))};const o=e.width-1,s=e.height-1,r=H.te;for(let e=0;e<r.length;e++){const t=r[e];for(let l=0;l<t.length;l++)t[l].H&&(l>0&&a(t[l-1],2),l<o&&a(t[l+1],8),e>0&&a(r[e-1][l],4),e<s&&a(r[e+1][l],1))}for(let e=l.length-1;e>=0;e--)t.push(l.splice(x(de()*e),1)[0]);let n=ne(t.length,0,t.length);for(let l=0;l<n;l++)if(de()<=e.h){let e=t.shift(),l=e.V,a=e.q,n=!0,i=(e,t)=>{r[e][t].oe&&(n=!1)};if(a>0&&i(l,a-1),a<o&&i(l,a+1),l>0&&i(l-1,a),l<s&&i(l+1,a),n)switch(e.oe=!0,e.H=!0,e.ae){case 1:console.log(`case:north (1) generating extra at r:${e.V} c:${e.q}`),Ie(r[e.V-1][e.q],4),Ie(e,1);break;case 4:console.log(`case:south (4) generating extra at r:${e.V} c:${e.q}`),Ie(r[e.V+1][e.q],1),Ie(e,4);break;case 2:console.log(`case:east (2) generating extra at r:${e.V} c:${e.q}`),Ie(r[e.V][e.q+1],8),Ie(e,2);break;default:console.log(`case:west (8) generating extra at r:${e.V} c:${e.q}`),Ie(r[e.V][e.q-1],2),Ie(e,8)}e.le=!1}}},He=()=>{P=H.te;let e,t,l,a=1,o=(e,t,l,a)=>N.clearRect(e,t,l,a),r=e=>N.fillStyle=`#${e}`,n=(e,t,l,a)=>N.fillRect(e,t,l,a),i=(e,a)=>{r(e),n(t,l,160,160),r(a),n(t+1,l+1,78,78),n(t+1,l+80+1,78,78),n(t+80+1,l+1,78,78),n(t+80+1,l+80+1,78,78)},c=(e,a,o)=>{i(a,o),Z.push({W:X.W,type:e,x:t,y:l})};o(0,0,804,804);for(let f=0;f<P.length;f++){e=P[f];for(let d=0;d<e.length;d++)if(X=e[d],X.x=160*d+80*(5-H.width),X.y=160*f+80*(5-H.height),X.H){t=X.x,l=X.y,H.height,X.oe?de()<.5?c(0,"48c","69c"):c(1,"a95","ba6"):(i("595","6a6"),X.X?(z=Ce(xe(t+80,l+80),6,1,0,1),z.se=!1,z.re=!0,console.log(`created ball at r:${f} c:${d}`)):X.Y?(Q.t=xe(t+80,l+80),N.beginPath(),N.arc(Q.t.x,Q.t.y,12,0,7),r("6a6"),N.fill(),N.stroke(),console.log(`created goal at r:${f} c:${d}`)):de()<te.u&&(de()<te.g?(I=Me(xe(t+80,l+80),100,8,0,1,1),de()<.5?I.U=1.5:I.U=-1.5,I.ne=!0,I.id=a++,I.re=!0,console.log(`created windmill at r:${f} c:${d}`)):(I=Me(xe(t+80,l+80),25,25,0,1,1),ye(I,.25*s),I.ie=!0,I.re=!0,console.log(`created blocker at r:${f} c:${d}`)))),r("232");let e=(e=0)=>{Me(xe(t+e,l+80),8,164,0,1,1),n(t-2+e,l-1,4,161)},h=(e=0)=>{Me(xe(t+160+e,l+80-1),8,162,0,1,1),n(t+160+e-4,l-1,4,161)},x=(e=0)=>{Me(xe(t+80,l+2+e),160,8,0,1,1),n(t-2,l-2+e,160,4)},_=(e=0)=>{Me(xe(t+80,l+160+e+2),160,8,0,1,1),n(t-2,l-2+160+e,162,4)};switch(X.W){case 1:e(),h(),X.oe?(o(t-2,l+80,164,81),_(-80)):_();break;case 2:_(),x(),X.oe?(o(t-2,l-2,82,164),e(80)):e();break;case 3:e(),_();break;case 4:e(),h(),X.oe?(o(t-2,l-1,164,80),x(80)):x();break;case 5:e(),h();break;case 6:e(),x();break;case 7:e();break;case 8:x(),_(),X.oe?(o(t+80,l-2,80,164),h(-80)):h();break;case 9:h(),_();break;case 10:x(),_();break;case 11:_();break;case 12:x(),h();break;case 13:h();break;case 14:x()}}}},Pe=(e,t,l,a,o,s,r,i,f,d,h,x=!1)=>{K.push({ce:e,fe:e,rotation:a,velocityX:c(a)*o,velocityY:n(a)*o,x:t,y:l,de:s,alpha:r,he:r,xe:i,_e:f,scale:d,be:d,clip:x,ue:h,ge:h[2]/2,Oe:h[3]/2})},Xe=()=>{Pe(.5,z.t.x,z.t.y,r*o.random(),100,!0,1,!0,!1,1,[1,1,32,32])},Ye=()=>{if(B){let e=ne(B.x,0,l.innerWidth),t=G.x-e,a=ne(B.y,0,l.innerHeight),o=G.y;G.x<B.x&&(e=G.x,t=B.x-e),G.y<B.y&&(a=G.y,o=B.y-a),k.clearRect(e-8,a-8,t+16,o+16)}};t.onmousedown=e=>{ee&&0===e.button&&2===j&&0===_e(z.A)&&(G=xe(e.x,e.y))},t.onmousemove=e=>{if(G&&ee&&2===j){Ye();let t=G.x,l=G.y,a=e.x,o=e.y;R=d(l-o,t-a);let r=d(o-l,a-t),i=.25*s,f=2*i,h=8*c(r-i),x=8*n(r-i),_=8*c(r+i),b=8*n(r+i),u=6*c(r-f),g=6*n(r-f),O=6*c(r+f),p=6*n(r+f);F=Ne(G,{x:a,y:o}),putterColor="fff",F<25&&(putterColor="f44"),F>400&&(F=400),a=c(r)*F+t,o=n(r)*F+l,B={x:a,y:o},k.strokeStyle=`#${putterColor}`,k.lineWidth=3,k.beginPath();let E=(e,t)=>{k.moveTo(e,t)},D=(e,t)=>{k.lineTo(e,t)};E(h+t,x+l),D(t,l),D(_+t,b+l),E(t,l),D(a,o),E(u+a,g+o),D(O+a,p+o),k.stroke()}},t.onmouseup=e=>{if(ee&&0===e.button&&G&&2===j&&(Ye(),B=null,G=null,F>25)){ee=!1,z.pe?(fx_play(1),Xe()):fx_play(2),L=z.t;let e=F/400;z.A=xe(c(R)*(700*e),n(R)*(700*e)),F=0,v.B++,v.total++,Ve()}},t.onkeyup=e=>{32===e.keyCode&&2===j&&(Ye(),B=null,G=null,F=0,e.preventDefault()),16===e.keyCode&&2===j&&(J=!1,oe("ss"),e.preventDefault())},t.onkeydown=e=>{16!==e.keyCode||2!==j||J||(console.log("tabby"),qe(),se("ss"),V=0,J=!0,e.preventDefault())},g=le("i"),D=ce(804,804,"bg"),N=D.O,$=ce(804,804,"bg"),S=$.O,m=ce(l.innerWidth,l.innerHeight,"fg"),k=m.O,fx_add([1,409,.01,.09,.09,1,.45,-11,3.5,0,0,0,0,0,0,0,.94,0,0]),fx_add([1,1888,0,.01,.11,4,2.88,0,-5.9,0,0,0,0,143,0,0,1,.11,0]),fx_add([1.99,9,.01,0,.01,3,1.94,0,-.3,0,0,0,0,0,0,.49,1,.03,0]),fx_add([3.35,1101,.02,0,0,0,2.14,0,-27,119,0,.02,1,0,0,.37,1,0,.42]),fx_add([1.22,681,.07,.15,.42,0,1.42,0,.3,-377,.14,.11,0,0,.1,.04,.88,.23,0]),fx_add([1.62,45,.02,.3,.34,1,1.21,0,0,172,.02,.18,0,0,.1,.08,.85,.17,.22]),fx_add([1,233,0,.11,.44,1,1.6,0,-.5,0,0,0,0,5.1,0,0,.88,.15,0]),fx_add([1.02,538,.01,.03,.18,0,1.42,.2,0,0,0,0,0,25,.1,0,.68,.03,.12]),fx_add([1,47,.01,.09,.09,4,1.81,0,0,0,0,0,0,0,0,0,.57,.02,0]),fx_add([1,377,.02,.01,.01,3,1.97,0,-34,613,.12,0,0,-84,0,0,1,.02,.07]),fx_add([1.88,575,.09,.18,.41,2,.09,-1.4,0,124,.18,.11,0,0,0,.16,.81,.21,.46]);let Je=()=>{let e=(e,t,l)=>{e.style.left=`${t}px`,e.style.top=`${l}px`},t=l.innerWidth/2-402,a=l.innerHeight/2-402,o=t-210,s=t+804,r=a+804-80;e(D,t,a),e($,t,a),e(le("hd"),o,a),e(le("pd"),s,a),e(le("td"),o,r),e(le("ad"),s,r)};l.onresize=Je,Je();let Ve=()=>{re("ht",v.G),re("pt",v.B),re("tt",v.total),re("at",x(v.total/v.G))},qe=()=>{Ke(),re("s1",`Holes in one: ${v.Ee}`),re("s2",`Holes in two: ${v.De}`),re("s3",`Holes in three: ${v.Ne}`),re("s4",`Close calls: ${v.$e}`),re("s5",`Bumps: ${v.Se}`),re("s6",`Flips: ${v.me}`),re("s7",`Rebounds: ${v.ke}`),re("s8",`Sand shots: ${v.ve}`),re("s9",`Water shots:  ${v.ye}`)},Ke=()=>{return re("s0","Play time: "+(t=v.Te+(Date.now()-e)/1e3,`${x(t/3600)}h, ${x(t%3600/60)}m, ${x(t%3600%60)}s`));var t};l.onbeforeunload=()=>{if($e.length>0){Y=[];for(let e=0;e<$e.length;e++)I=$e[e],I.ne&&Y.push({id:I.id,U:I.U,M:I.M});v.Ae=Y}v.we=z,v.Te+=(Date.now()-e)/1e3,a.setItem("com.antix.miniputtgolf",JSON.stringify(v))},(()=>{if(Y=a.getItem("com.antix.miniputtgolf"),!Y)return v={seed:11091968,we:null,Ae:null,G:1,B:0,total:0,ve:0,ye:0,Ee:0,De:0,Ne:0,$e:0,Se:0,me:0,ke:0,Te:0},fe.p(v.seed),console.log("game state created"),se("ts"),!1;{v=JSON.parse(Y),fe.p(v.seed),console.log("game state loaded"),Le(),console.log("restoring game state");let e=e=>{for(let t=0;t<$e.length;t++)if(I=$e[t],I.ne&&I.id===e)return I};if(v.Ae)for(let t=0;t<v.Ae.length;t++)Y=v.Ae[t],I=e(Y.id),I.U=Y.U,ye(I,Y.M);v.we&&($e.splice($e.indexOf(z),1),z=v.we,$e.push(z),console.log("BALL:"),console.log(z),z.se?(console.log("gamestate thinks ball is in goal"),z.A=xe(0,0),ae(0),ie(0),Ue()):(ae(1),ie(2),ee=!0)),Ve(),se("hud")}})(),console.log("GAMESTATE:"),console.log(v);let je=()=>{for(q=!1,O=Date.now(),E=(O-p)/1e3,p=O,J&&(V+=E,V>=1&&(V-=1,Ke())),i=$e.length;i--;){let e=$e[i];e.A=be(e.A,ge(e.C,E)),ve(e,ge(e.A,E)),e.U+=e.a*E,ye(e,e.U*E)}switch((()=>{for(i=$e.length;i--;)if($e[i]!=z){let l=$e[i];if(e=l,_e(ue((t=z).t,e.t))<=e.l+t.l&&Ae(l,z))return Oe(Se.$,ue(z.t,l.t))<0&&(Se={N:Se.N,$:ge(Se.$,-1),S:Se.E,E:Se.S}),we(l,z,Se),z.se||(l.ne?(fx_play(9),v.me++,q=!0,console.log("ball hit windmill")):l.ie?(fx_play(8),v.Se++,q=!0,console.log("ball hit blocker")):(fx_play(3),v.ke++,q=!0,console.log("ball hit wall"))),void(G&&(Ye(),G=null,B=null,ee=!1))}var e,t})(),j){case 2:let e=z.t.x,t=z.t.y,l=!1;if(e>0||e<804||t>0||t<804){P=H.te,X=P[0][0],P[x((t-X.y)/160)][x((e-X.x)/160)].H||(l=!0,console.log("ball escaped confines of hole"))}else l=!0,console.log("ball entirely left the canvas!");l&&(z.t=L,z.A=xe(0,0),v.B--,q=!0,ee=!0);let a=_e(z.A);if(a>0){U=.985,(()=>{let e=z.t.x;T=z.t.y;for(let t=0;t<Z.length;t++){const l=Z[t];if(e>l.x&&e<l.x+160&&T>l.y&&T<l.y+160)if(1===l.type)z.pe||(Xe(),fx_play(1),v.ve++),z.pe=!0,U=.75;else{switch(l.W){case 1:e=l.x+80,T=l.y-8,A=l.x,w=l.y,C=160,M=80;break;case 2:e=l.x+160+8,T=l.y+80,A=l.x+80,w=l.y,C=80,M=160;break;case 4:e=l.x+80,T=l.y+160+8,A=l.x,w=l.y+80,C=160,M=80;break;default:e=l.x-8,T=l.y+80,A=l.x,w=l.y,C=80,M=160}Pe(.5,z.t.x,z.t.y,0,0,!0,1,!1,!0,8,[36,1,26,26],!0),fx_play(0),z.t=xe(e,T),z.A=xe(0,0),ee=!0,v.ye++,q=!0}else z.pe=void 0}})(),z.A=ge(z.A,U);let e=Ne(z.t,Q.t);if(a<10&&(z.A=xe(0,0),z.se?(y=1,ie(3)):(e<25&&(fx_play(6),v.$e++,q=!0),ee=!0)),!z.se&&e<=12){z.A=ge(z.A,.5);let e=Q.t.x,t=Q.t.y;if(Me(xe(e-20,t),16,40,0,1,1),Me(xe(e+20,t),16,40,0,1,1),Me(xe(e,t-20),40,16,0,1,1),Me(xe(e,t+20),40,16,0,1,1),1===v.B){let e=0;for(let t=0;t<9;t++)Pe(1.5,Q.t.x,Q.t.y,e,125,!0,1,!1,!1,1,[63,1,24,23]),e+=r/9;fx_play(5),v.Ee++,q=!0}else fx_play(4),2==v.B?(v.De++,q=!0):3==v.B&&(v.Ne++,q=!0);console.log("The ball is in the goal"),z.se=!0,ee=!1}else z.se&&e>25&&(z.t=Q.t,console.log("ball is in goal, but outside goal at the same time. fixed"))}break;case 3:y-=E,y<=0&&(y=0,ie(0),Ue()),ae(y);break;case 4:y+=E,y>=1&&(y=1,ie(2),ee=!0),ae(y)}for(S.clearRect(0,0,804,804),S.strokeStyle="#222",S.lineJoin="bevel",i=$e.length;i--;){let e=$e[i];e.re&&(S.save(),S.translate(e.t.x,e.t.y),S.rotate(e.M),e.m?(S.fillStyle="#aaa",S.strokeRect(-e.L/2,-e.I/2,e.L,e.I),S.fillRect(-e.L/2,-e.I/2,e.L,e.I)):(S.fillStyle="#eee",S.beginPath(),S.arc(0,0,e.l,0,7),S.fill(),S.stroke()),S.restore())}for(let e=K.length-1;e>=0;e--){let t=K[e];t.fe-=E,t.fe<=0?K.splice(e,1):(t.x+=t.velocityX*E,t.y+=t.velocityY*E,ratio=t.fe/t.ce,t.de&&(t.alpha=t.he*ratio),t.xe&&(t.scale=t.be*ratio),t._e&&(t.scale=t.be-t.be*ratio),S.save(),t.clip&&(S.beginPath(),S.rect(A,w,C,M),S.clip()),S.globalAlpha=t.alpha,S.translate(t.x,t.y),S.scale(t.scale,t.scale),S.rotate(t.rotation),S.drawImage(g,t.ue[0],t.ue[1],t.ue[2],t.ue[3],-t.ge,-t.Oe,t.ue[2],t.ue[3]),S.restore())}q&&qe(),requestAnimationFrame(je)};p=Date.now(),je();let jf=()=>{console.log("pooh"),fx_play(7),oe("ts"),ie(1),se("is")},jg=()=>{console.log("wee"),fx_play(7),oe("is"),ae(0),Le(),se("hud"),y=0,ie(4)};</script></html>